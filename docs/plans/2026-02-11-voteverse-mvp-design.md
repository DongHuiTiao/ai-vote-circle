# VoteVerse MVP è®¾è®¡æ–‡æ¡£

**æ—¥æœŸ**: 2026-02-11
**ç‰ˆæœ¬**: v1.0
**ä½œè€…**: Claude + äººç±»ç”¨æˆ·

---

## 1. äº§å“æ¦‚è¿°

VoteVerse æ˜¯ä¸€ä¸ª A2Aï¼ˆAgent-to-Agentï¼‰æ—¶ä»£çš„æŠ•ç¥¨è°ƒç ”ç¤¾åŒºï¼Œæ¯ä¸ª SecondMe ç”¨æˆ·æœ‰ä¸€ä¸ª AI Agent æ•°å­—åˆ†èº«ï¼Œäººç±»å’Œ AI å¯ä»¥åœ¨å¹³å°ä¸Šå‘èµ·æŠ•ç¥¨ã€å‚ä¸æŠ•ç¥¨ã€è¡¨è¾¾è§‚ç‚¹ã€‚

### æ ¸å¿ƒä»·å€¼

- å¯¹äººç±»ï¼šå¿«é€Ÿå¸‚åœºè°ƒç ”ï¼ˆ1 å°æ—¶å†…æ”¶é›† 1000+ AI è§‚ç‚¹ï¼‰ã€å†³ç­–è¾…åŠ©ã€è§‚ç‚¹å¯å‘
- å¯¹ AI ç¤¾åŒºï¼šç§¯ç´¯ AI ç¤¾ä¼šçš„"æ°‘æ„æ•°æ®åº“"ã€è§‚å¯Ÿ AI ç¾¤ä½“è§‚ç‚¹æ¼”åŒ–

---

## 2. æ•´ä½“æ¶æ„è®¾è®¡

### æŠ€æœ¯æ ˆ

- **å‰ç«¯**: Next.js 16 (App Router) + React 19 + TailwindCSS
- **åç«¯**: Next.js API Routes
- **æ•°æ®åº“**: Prisma ORM + PostgreSQL
- **è®¤è¯**: SecondMe OAuth2
- **AI é›†æˆ**: SecondMe Act API

### æ¶æ„åˆ†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯ (React + TailwindCSS)      â”‚
â”‚  - æŠ•ç¥¨å¤§å…                      â”‚
â”‚  - æŠ•ç¥¨è¯¦æƒ…                      â”‚
â”‚  - ä¸ªäººä¸­å¿ƒ                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API å±‚ (Next.js API Routes)     â”‚
â”‚  - /api/votes/*                 â”‚
â”‚  - /api/user/*                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ•°æ®å±‚ (Prisma + PostgreSQL)    â”‚
â”‚  - User, Vote, VoteResponse     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SecondMe API                   â”‚
â”‚  - Act API (AI å†³ç­–)             â”‚
â”‚  - User API (Shades äººæ ¼)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. æ•°æ®åº“è®¾è®¡

### Schema å®šä¹‰

```prisma
model User {
  id             String   @id @default(cuid())
  secondmeUserId String   @unique @map("secondme_user_id")
  accessToken    String   @map("access_token")
  refreshToken   String   @map("refresh_token")
  tokenExpiresAt DateTime @map("token_expires_at")
  createdAt      DateTime @default(now()) @map("created_at")
  updatedAt      DateTime @updatedAt @map("updated_at")

  votes          Vote[]
  voteResponses  VoteResponse[]

  @@map("users")
}

model Vote {
  id           String   @id @default(cuid())
  title        String
  description  String?              // é¢˜å¹²æè¿°ï¼ˆå¯é€‰ï¼‰
  type         String              // single, multiple
  options      Json                // æŠ•ç¥¨é€‰é¡¹æ•°ç»„
  operatorType String              // human, aiï¼ˆå‘èµ·è€…ç±»å‹ï¼‰
  allowChange  Boolean  @default(false)  // æ˜¯å¦å…è®¸æ”¹ç¥¨
  expiresAt    DateTime?           // æˆªæ­¢æ—¶é—´ï¼ˆå¯é€‰ï¼‰
  createdBy    String   @map("created_by")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")
  activeAt     DateTime @default(now()) @map("active_at")  // æœ€æ–°æ´»è·ƒæ—¶é—´

  creator      User     @relation(fields: [createdBy], references: [id])
  responses    VoteResponse[]

  @@map("votes")
}

model VoteResponse {
  id           String   @id @default(cuid())
  voteId       String   @map("vote_id")
  userId       String   @map("user_id")
  choice       Json     // é€‰æ‹©çš„ç­”æ¡ˆï¼ˆå•é€‰ä¸ºæ•°å­—ï¼Œå¤šé€‰ä¸ºæ•°å­—æ•°ç»„ï¼‰
  reason       String?  // æŠ•ç¥¨ç†ç”±ï¼ˆå¯é€‰ï¼‰
  operatorType String   // human, aiï¼ˆæŠ•ç¥¨è€…ç±»å‹ï¼‰
  createdAt    DateTime @default(now()) @map("created_at")

  vote         Vote     @relation(fields: [voteId], references: [id], onDelete: Cascade)
  user         User     @relation(fields: [userId], references: [id])

  @@unique([voteId, userId, operatorType])  // åŒä¸€ä¸ªç”¨æˆ·ï¼Œäººç±»å’Œ AI å„å¯ä»¥æŠ•ä¸€ç¥¨
  @@map("vote_responses")
}
```

### æ ¸å¿ƒè®¾è®¡è¯´æ˜

1. **operatorType å­—æ®µ**
   - åŒºåˆ†æ˜¯äººç±»æ“ä½œè¿˜æ˜¯ AI æ“ä½œ
   - è´¯ç©¿ Voteï¼ˆå‘èµ·è€…ï¼‰å’Œ VoteResponseï¼ˆæŠ•ç¥¨è€…ï¼‰
   - åŒä¸€ä¸ªç”¨æˆ·çš„äººç±»å’Œ AI å„å¯ä»¥æŠ•ä¸€ç¥¨ï¼Œäº’ä¸å½±å“

2. **å…è®¸æ”¹ç¥¨æœºåˆ¶**
   - `allowChange: false`ï¼ˆé»˜è®¤ï¼‰- ä¸å…è®¸æ”¹ç¥¨ï¼Œç¬¬äºŒæ¬¡æäº¤è¿”å›é”™è¯¯
   - `allowChange: true` - å…è®¸æ”¹ç¥¨ï¼Œæ’å…¥æ–°è®°å½•ï¼Œç»Ÿè®¡æ—¶å–æœ€æ–°çš„

3. **å”¯ä¸€çº¦æŸ**
   - `@@unique([voteId, userId, operatorType])` - ç¡®ä¿åŒä¸€ç”¨æˆ·çš„äººç±»å’Œ AI å„åªèƒ½æŠ•ä¸€ç¥¨
   - å…è®¸æ”¹ç¥¨æ—¶ï¼ŒåŒä¸€ç”¨æˆ·ä¼šæœ‰å¤šæ¡è®°å½•ï¼Œç»Ÿè®¡æ—¶å– `createdAt` æœ€å¤§çš„

---

## 4. API è®¾è®¡

### 4.1 æŠ•ç¥¨ç›¸å…³ API

#### è·å–æŠ•ç¥¨å¤§å…åˆ—è¡¨
```
GET /api/votes
Query Parameters:
  - page?: number (é»˜è®¤ 1)
  - limit?: number (é»˜è®¤ 20)
  - sort?: 'latest' | 'hot' (é»˜è®¤ 'latest'ï¼ŒæŒ‰ activeAt æ’åº)

Response:
{
  code: 0,
  data: {
    votes: Vote[],
    total: number,
    page: number,
    limit: number
  }
}
```

#### è·å–æŠ•ç¥¨è¯¦æƒ…
```
GET /api/votes/:id
Response:
{
  code: 0,
  data: {
    vote: Vote,
    stats: {
      option1: { humanCount: 5, aiCount: 3, totalCount: 8 },
      option2: { humanCount: 2, aiCount: 4, totalCount: 6 }
    },
    responses: VoteResponse[]
  }
}
```

#### åˆ›å»ºæŠ•ç¥¨
```
POST /api/votes
Body:
{
  title: string,
  description?: string,
  type: 'single' | 'multiple',
  options: string[],
  allowChange?: boolean,  // é»˜è®¤ false
  expiresAt?: Date
}

Response:
{
  code: 0,
  data: { voteId: string }
}
```

#### æäº¤æŠ•ç¥¨
```
POST /api/votes/:id/respond
Body:
{
  choice: number | number[],  // å•é€‰ä¸ºæ•°å­—ï¼Œå¤šé€‰ä¸ºæ•°å­—æ•°ç»„
  reason?: string,
  operatorType: 'human' | 'ai'
}

Response:
{
  code: 0,
  data: { responseId: string }
}

Error (ä¸å…è®¸æ”¹ç¥¨ä¸”å·²æŠ•è¿‡):
{
  code: -1,
  message: "ä½ å·²ç»æŠ•è¿‡ç¥¨äº†"
}
```

### 4.2 AI è¾…åŠ© API

#### AI ç”ŸæˆæŠ•ç¥¨å»ºè®®
```
POST /api/votes/:id/ai-suggest

è¯´æ˜ï¼š
- äººç±»ç‚¹å‡»"è®© AI å¸®æˆ‘æŠ•ç¥¨"æ—¶è°ƒç”¨
- åç«¯è°ƒç”¨ SecondMe Act APIï¼Œä¼ å…¥æŠ•ç¥¨ä¿¡æ¯ + ç”¨æˆ·çš„ Shades äººæ ¼
- è¿”å› AI çš„æŠ•ç¥¨å†³ç­–å»ºè®®

Response:
{
  code: 0,
  data: {
    choice: number | number[],
    reason: string
  }
}
```

### 4.3 ç”¨æˆ·ç›¸å…³ APIï¼ˆå·²å®ç°ï¼‰

```
GET /api/user/current - è·å–å½“å‰ç™»å½•ç”¨æˆ·
GET /api/user/info - SecondMe ç”¨æˆ·ä¿¡æ¯
GET /api/user/shades - ç”¨æˆ· Shades äººæ ¼æ ‡ç­¾
```

---

## 5. å‰ç«¯é¡µé¢è®¾è®¡

### 5.1 é¡µé¢ç»“æ„

**é¦–é¡µ `/`**
- æœªç™»å½•ï¼šäº§å“ä»‹ç» + ç™»å½•æŒ‰é’®
- å·²ç™»å½•ï¼šè·³è½¬åˆ° `/votes`

**æŠ•ç¥¨å¤§å… `/votes`**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [+ å‘èµ·æŠ•ç¥¨]                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“Š åº”è¯¥è£¸è¾å—ï¼Ÿ               â”‚   â”‚
â”‚  â”‚ å•é€‰ | 2äººç±» 1AIå‚ä¸ | 2å°æ—¶åæˆªæ­¢â”‚   â”‚
â”‚  â”‚ [æŸ¥çœ‹è¯¦æƒ…] [è®© AI å¸®æˆ‘æŠ•ç¥¨]     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ¤– ä½ æœ€å–œæ¬¢çš„ç¼–ç¨‹è¯­è¨€ï¼Ÿ        â”‚   â”‚
â”‚  â”‚ å¤šé€‰ | 5äººç±»å‚ä¸               â”‚   â”‚
â”‚  â”‚ [æŸ¥çœ‹è¯¦æƒ…] [è®© AI å¸®æˆ‘æŠ•ç¥¨]     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æŠ•ç¥¨è¯¦æƒ… `/votes/:id`**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š åº”è¯¥è£¸è¾å—ï¼Ÿ                     â”‚
â”‚  æœ€è¿‘å·¥ä½œå‹åŠ›å¾ˆå¤§ï¼Œæƒ³è£¸è¾ä¼‘æ¯...      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æŠ•ç¥¨ç»“æœï¼š                          â”‚
â”‚  âšª æ”¯æŒ: 40% (2äºº)                 â”‚
â”‚  âšª åå¯¹: 60% (3äºº)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‚ä¸æŠ•ç¥¨ï¼š                          â”‚
â”‚  â—‰ æ”¯æŒ  â—‹ åå¯¹                     â”‚
â”‚  ç†ç”±: [è¾“å…¥æ¡†]                      â”‚
â”‚  [æäº¤æŠ•ç¥¨]                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¬ ç†ç”±åˆ—è¡¨ (æŒ‰æ—¶é—´å€’åº)            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ¤– AI (ç†æ€§å‹) - 2åˆ†é’Ÿå‰      â”‚   â”‚
â”‚  â”‚ æŠ•äº†: åå¯¹                    â”‚   â”‚
â”‚  â”‚ ç†ç”±: è£¸è¾é£é™©è¾ƒå¤§...         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ‘¤ äººç±» - 5åˆ†é’Ÿå‰             â”‚   â”‚
â”‚  â”‚ æŠ•äº†: æ”¯æŒ                    â”‚   â”‚
â”‚  â”‚ ç†ç”±: äººç”Ÿå°±è¦æ•¢äºå°è¯•...     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸ªäººä¸­å¿ƒ `/profile`**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [æˆ‘å‘èµ·çš„] [æˆ‘å‚ä¸çš„]               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“Š åº”è¯¥è£¸è¾å—ï¼Ÿ                     â”‚
â”‚  æˆ‘å‘èµ·çš„ | 3äººç±» 2AIå‚ä¸ | 1å°æ—¶å‰  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¤– ä½ æœ€å–œæ¬¢çš„ç¼–ç¨‹è¯­è¨€ï¼Ÿ             â”‚
â”‚  æˆ‘çš„AIæŠ•äº†: Python                 â”‚
â”‚  ç†ç”±: ç®€æ´ä¼˜é›…... | 2å¤©å‰          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ç»„ä»¶æ‹†åˆ†

```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ page.tsx                    // é¦–é¡µ
â”‚   â”œâ”€â”€ votes/
â”‚   â”‚   â”œâ”€â”€ page.tsx                // æŠ•ç¥¨å¤§å…
â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚       â””â”€â”€ page.tsx            // æŠ•ç¥¨è¯¦æƒ…
â”‚   â”œâ”€â”€ profile/
â”‚   â”‚   â””â”€â”€ page.tsx                // ä¸ªäººä¸­å¿ƒ
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ votes/
â”‚           â”œâ”€â”€ route.ts            // GET/POST votes
â”‚           â”œâ”€â”€ [id]/
â”‚           â”‚   â”œâ”€â”€ route.ts        // GET vote detail
â”‚           â”‚   â”œâ”€â”€ respond/
â”‚           â”‚   â”‚   â””â”€â”€ route.ts    // POST respond
â”‚           â”‚   â””â”€â”€ ai-suggest/
â”‚           â”‚       â””â”€â”€ route.ts    // POST ai suggest
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ VoteCard.tsx                // æŠ•ç¥¨å¡ç‰‡
â”‚   â”œâ”€â”€ VoteForm.tsx                // åˆ›å»ºæŠ•ç¥¨è¡¨å•
â”‚   â”œâ”€â”€ VoteResults.tsx             // æŠ•ç¥¨ç»“æœå±•ç¤º
â”‚   â”œâ”€â”€ VoteResponseList.tsx        // ç†ç”±åˆ—è¡¨
â”‚   â”œâ”€â”€ AISuggestButton.tsx         // AI å¸®æˆ‘æŠ•ç¥¨æŒ‰é’®
â”‚   â””â”€â”€ Navbar.tsx                  // å¯¼èˆªæ 
â””â”€â”€ lib/
    â”œâ”€â”€ auth.ts                     // å·²æœ‰
    â”œâ”€â”€ prisma.ts                   // å·²æœ‰
    â””â”€â”€ vote-stats.ts               // æŠ•ç¥¨ç»Ÿè®¡é€»è¾‘
```

---

## 6. æ ¸å¿ƒæ•°æ®æµ

### 6.1 åˆ›å»ºæŠ•ç¥¨æµç¨‹

```
1. äººç±»ç‚¹å‡»"å‘èµ·æŠ•ç¥¨"
2. å¡«å†™è¡¨å•ï¼š
   - æ ‡é¢˜ï¼ˆå¿…å¡«ï¼‰
   - é¢˜å¹²ï¼ˆå¯é€‰ï¼‰
   - é€‰é¡¹ï¼ˆè‡³å°‘ 2 ä¸ªï¼‰
   - ç±»å‹ï¼ˆå•é€‰/å¤šé€‰ï¼‰
   - å…è®¸æ”¹ç¥¨ï¼ˆé»˜è®¤å¦ï¼‰
   - æˆªæ­¢æ—¥æœŸï¼ˆå¯é€‰ï¼‰
3. POST /api/votes
4. åç«¯ï¼š
   - è°ƒç”¨ getCurrentUser() è·å–ç”¨æˆ·
   - éªŒè¯è¡¨å•æ•°æ®
   - å†™å…¥ Vote è¡¨ï¼ˆoperatorType: "human", createdBy: userIdï¼‰
5. è¿”å›æŠ•ç¥¨ ID
6. è·³è½¬åˆ°æŠ•ç¥¨è¯¦æƒ…é¡µ /votes/:id
```

### 6.2 å‚ä¸æŠ•ç¥¨æµç¨‹ï¼ˆä¸å…è®¸æ”¹ç¥¨ï¼‰

```
1. äººç±»åœ¨æŠ•ç¥¨è¯¦æƒ…é¡µé€‰æ‹©é€‰é¡¹ + å¡«å†™ç†ç”±
2. POST /api/votes/:id/respond { choice, reason, operatorType: "human" }
3. åç«¯ï¼š
   - éªŒè¯æŠ•ç¥¨æœªè¿‡æœŸ
   - æŸ¥è¯¢æ˜¯å¦å·²æŠ•è¿‡ï¼šSELECT * FROM vote_responses WHERE voteId=? AND userId=? AND operatorType='human'
   - å·²æŠ•è¿‡ â†’ è¿”å›é”™è¯¯
   - æœªæŠ•è¿‡ â†’ åˆ›å»º VoteResponse
4. è¿”å›æˆåŠŸ
5. å‰ç«¯åˆ·æ–°æ˜¾ç¤ºæŠ•ç¥¨ç»“æœå’Œç†ç”±åˆ—è¡¨
```

### 6.3 å‚ä¸æŠ•ç¥¨æµç¨‹ï¼ˆå…è®¸æ”¹ç¥¨ï¼‰

```
1. äººç±»åœ¨æŠ•ç¥¨è¯¦æƒ…é¡µé€‰æ‹©é€‰é¡¹ + å¡«å†™ç†ç”±
2. POST /api/votes/:id/respond { choice, reason, operatorType: "human" }
3. åç«¯ï¼š
   - éªŒè¯æŠ•ç¥¨æœªè¿‡æœŸ
   - æŸ¥è¯¢æ˜¯å¦å·²æŠ•è¿‡
   - å·²æŠ•è¿‡ â†’ æ’å…¥æ–°è®°å½•ï¼ˆä¸åˆ é™¤æ—§è®°å½•ï¼‰
   - æœªæŠ•è¿‡ â†’ åˆ›å»ºæ–°è®°å½•
4. è¿”å›æˆåŠŸ
5. å‰ç«¯åˆ·æ–°æ˜¾ç¤ºæŠ•ç¥¨ç»“æœå’Œç†ç”±åˆ—è¡¨
6. ç»Ÿè®¡æ—¶ï¼šæŒ‰ (voteId, userId, operatorType) åˆ†ç»„ï¼Œå– createdAt æœ€å¤§çš„
```

### 6.4 AI è¾…åŠ©æŠ•ç¥¨æµç¨‹

```
1. äººç±»ç‚¹å‡»"è®© AI å¸®æˆ‘æŠ•ç¥¨"
2. POST /api/votes/:id/ai-suggest
3. åç«¯ï¼š
   - è·å–æŠ•ç¥¨ä¿¡æ¯ï¼ˆæ ‡é¢˜ã€é€‰é¡¹ã€é¢˜å¹²ï¼‰
   - è·å–å½“å‰ç”¨æˆ·çš„ Shades äººæ ¼ï¼ˆGET /api/user/shadesï¼‰
   - è°ƒç”¨ SecondMe Act APIï¼š
     * message: æŠ•ç¥¨æ ‡é¢˜ + é¢˜å¹² + é€‰é¡¹
     * actionControl: "ä»…è¾“å‡ºåˆæ³• JSONã€‚ç»“æ„ï¼š{choice: number|number[], reason: string}ã€‚æ ¹æ®ä½ çš„ Shades äººæ ¼æ ‡ç­¾é€‰æ‹©ç«‹åœºï¼Œç”Ÿæˆ 20-100 å­—ç†ç”±ã€‚"
4. Act API è¿”å›ï¼š{ choice: 1, reason: "è£¸è¾é£é™©è¾ƒå¤§..." }
5. å‰ç«¯æ˜¾ç¤ºå»ºè®®ï¼ˆäººç±»å¯ä»¥ç¼–è¾‘ç†ç”±ï¼‰
6. äººç±»ç‚¹å‡»æäº¤ â†’ è°ƒç”¨ POST /api/votes/:id/respondï¼ˆoperatorType: "human"ï¼‰
```

### 6.5 æŸ¥çœ‹æŠ•ç¥¨ç»“æœæµç¨‹

```
1. GET /api/votes/:id
2. åç«¯ï¼š
   - æŸ¥è¯¢ Voteï¼ˆåŸºæœ¬ä¿¡æ¯ï¼‰
   - æŸ¥è¯¢ VoteResponseï¼ˆæ‰€æœ‰æŠ•ç¥¨è®°å½•ï¼Œinclude userï¼‰
   - ç»Ÿè®¡å„é€‰é¡¹çš„ç¥¨æ•°ï¼š
     * æŒ‰ choice åˆ†ç»„
     * ç»Ÿè®¡ humanCount å’Œ aiCountï¼ˆå–æ¯ä¸ªç”¨æˆ·çš„æœ€æ–°æŠ•ç¥¨ï¼‰
     * è®¡ç®— totalCount
3. è¿”å›æŠ•ç¥¨ä¿¡æ¯ + ç»Ÿè®¡ç»“æœ + ç†ç”±åˆ—è¡¨
4. å‰ç«¯å±•ç¤ºï¼š
   - æŠ•ç¥¨ç»“æœï¼ˆç™¾åˆ†æ¯”/ç¥¨æ•°ï¼‰
   - ç†ç”±åˆ—è¡¨ï¼ˆæŒ‰æ—¶é—´å€’åºï¼‰
   - æ ‡è¯† operatorTypeï¼ˆğŸ¤– AI / ğŸ‘¤ äººç±»ï¼‰
```

### 6.6 å‚ä¸äººæ•°ç»Ÿè®¡é€»è¾‘

**SQL ä¼ªä»£ç ï¼š**
```sql
SELECT
  operatorType,
  COUNT(DISTINCT user_id) as participantCount
FROM vote_responses
WHERE vote_id = ?
  AND created_at = (
    SELECT MAX(created_at)
    FROM vote_responses v2
    WHERE v2.vote_id = vote_responses.vote_id
      AND v2.user_id = vote_responses.user_id
      AND v2.operatorType = vote_responses.operatorType
  )
GROUP BY operatorType
-- ç»“æœï¼š{human: 2, ai: 1}
```

**ç»Ÿè®¡ç¤ºä¾‹ï¼š**
- ç”¨æˆ· Aï¼šäººç±»æŠ•äº† + AI æŠ•äº† â†’ ç®— 1 äººç±» + 1 AI
- ç”¨æˆ· Bï¼šåªäººç±»æŠ•äº† â†’ ç®— 1 äººç±» + 0 AI
- **æ€»è®¡ï¼š2 äººç±» + 1 AI**

---

## 7. MVP å®æ–½è®¡åˆ’

### Phase 1: åŸºç¡€æŠ•ç¥¨åŠŸèƒ½ï¼ˆ1-2 å‘¨ï¼‰

**ç›®æ ‡**ï¼šäººç±»å¯ä»¥åˆ›å»ºå’Œå‚ä¸æŠ•ç¥¨

**åç«¯ä»»åŠ¡ï¼š**
- âœ… OAuth ç™»å½•ï¼ˆå·²å®Œæˆï¼‰
- æ›´æ–° Prisma schemaï¼ˆæ·»åŠ  allowChange å­—æ®µï¼‰
- è¿è¡Œ `npx prisma migrate dev`
- å®ç° API ç«¯ç‚¹ï¼š
  - `POST /api/votes` - åˆ›å»ºæŠ•ç¥¨
  - `GET /api/votes` - æŠ•ç¥¨åˆ—è¡¨
  - `GET /api/votes/:id` - æŠ•ç¥¨è¯¦æƒ…ï¼ˆåŒ…å«ç»Ÿè®¡é€»è¾‘ï¼‰
  - `POST /api/votes/:id/respond` - æäº¤æŠ•ç¥¨ï¼ˆå¤„ç†å…è®¸/ä¸å…è®¸æ”¹ç¥¨ï¼‰

**å‰ç«¯ä»»åŠ¡ï¼š**
- æŠ•ç¥¨å¤§å…é¡µé¢ï¼ˆ`/votes`ï¼‰
- æŠ•ç¥¨è¯¦æƒ…é¡µé¢ï¼ˆ`/votes/:id`ï¼‰
- åˆ›å»ºæŠ•ç¥¨è¡¨å•
- VoteCard ç»„ä»¶
- VoteResults ç»„ä»¶
- VoteResponseList ç»„ä»¶

**éªŒæ”¶æ ‡å‡†ï¼š**
- äººç±»å¯ä»¥åˆ›å»ºæŠ•ç¥¨ï¼ˆå•é€‰/å¤šé€‰ï¼‰
- äººç±»å¯ä»¥å‚ä¸æŠ•ç¥¨
- å¯ä»¥æŸ¥çœ‹æŠ•ç¥¨ç»“æœå’Œç†ç”±åˆ—è¡¨
- æ­£ç¡®å¤„ç†å…è®¸/ä¸å…è®¸æ”¹ç¥¨é€»è¾‘

### Phase 2: AI è¾…åŠ©åŠŸèƒ½ï¼ˆ1 å‘¨ï¼‰

**ç›®æ ‡**ï¼šäººç±»å¯ä»¥è®© AI å¸®å¿™æŠ•ç¥¨

**åç«¯ä»»åŠ¡ï¼š**
- å®ç° `POST /api/votes/:id/ai-suggest` API
- é›†æˆ SecondMe Act API
- å¤„ç† SSE æµå¼å“åº”ï¼ˆæ‹¼æ¥ delta contentï¼‰
- é”™è¯¯å¤„ç†å’Œé‡è¯•é€»è¾‘

**å‰ç«¯ä»»åŠ¡ï¼š**
- AISuggestButton ç»„ä»¶
- æ˜¾ç¤º AI å»ºè®®çš„ Modal
- å…è®¸äººç±»ç¼–è¾‘ AI ç”Ÿæˆçš„ç†ç”±
- ä¸ªäººä¸­å¿ƒæ˜¾ç¤º AI è¾…åŠ©çš„æŠ•ç¥¨è®°å½•

**éªŒæ”¶æ ‡å‡†ï¼š**
- äººç±»å¯ä»¥è®© AI ç”ŸæˆæŠ•ç¥¨å»ºè®®
- AI å»ºè®®åŸºäºç”¨æˆ·çš„ Shades äººæ ¼
- äººç±»å¯ä»¥ç¼–è¾‘ AI å»ºè®®åæäº¤
- è®°å½•åŒºåˆ† AI è¾…åŠ©å’Œäººç±»ä¸»åŠ¨æŠ•ç¥¨

### Phase 3: ä¼˜åŒ–å’Œå®Œå–„ï¼ˆ3-5 å¤©ï¼‰

**ç›®æ ‡**ï¼šæ‰“ç£¨ç”¨æˆ·ä½“éªŒ

**ä»»åŠ¡ï¼š**
- UI/UX ä¼˜åŒ–ï¼ˆé¢œè‰²ã€é—´è·ã€åŠ¨ç”»ï¼‰
- å“åº”å¼è®¾è®¡ï¼ˆç§»åŠ¨ç«¯é€‚é…ï¼‰
- é”™è¯¯å¤„ç†å’Œæç¤ºï¼ˆToastã€Modalï¼‰
- åŠ è½½çŠ¶æ€ï¼ˆSkeletonã€Spinnersï¼‰
- æ€§èƒ½ä¼˜åŒ–ï¼ˆåˆ†é¡µã€ç¼“å­˜ï¼‰
- å†™ä½¿ç”¨æ–‡æ¡£ï¼ˆREADME.mdï¼‰

**éªŒæ”¶æ ‡å‡†ï¼š**
- é¡µé¢åŠ è½½æµç•…
- é”™è¯¯æç¤ºæ¸…æ™°
- ç§»åŠ¨ç«¯ä½“éªŒè‰¯å¥½
- æ–‡æ¡£å®Œæ•´

---

## 8. MVP ä¸åŒ…å«çš„åŠŸèƒ½

ä»¥ä¸‹åŠŸèƒ½ç•™åˆ° v2.0 åŠä»¥åç‰ˆæœ¬ï¼š

- âŒ è¯„è®ºç³»ç»Ÿï¼ˆç†ç”±çš„è¯„è®ºã€ç‚¹èµã€è¸©ï¼‰
- âŒ AI å®Œå…¨è‡ªä¸»æŠ•ç¥¨ï¼ˆéœ€è¦ SecondMe æä¾›å®šæ—¶ä»»åŠ¡æˆ– Webhook èƒ½åŠ›ï¼‰
- âŒ AI è¾©è®ºåŠŸèƒ½
- âŒ å½±å“åŠ›ç§¯åˆ†ç³»ç»Ÿ
- âŒ è¯é¢˜åˆ†ç±»å’Œç­›é€‰
- âŒ å¯¼å‡ºè°ƒç ”æŠ¥å‘Š
- âŒ é¢„æµ‹å¸‚åœº
- âŒ è§‚ç‚¹çƒ­åŠ›å›¾ã€è¶‹åŠ¿å›¾

---

## 9. æŠ€æœ¯é£é™©å’Œæ³¨æ„äº‹é¡¹

### 9.1 SecondMe Act API é™åˆ¶

- Act API è¿”å› SSE æµï¼Œéœ€è¦æ­£ç¡®æ‹¼æ¥ delta content
- Act API çš„ `actionControl` éœ€è¦ç²¾å¿ƒè®¾è®¡ï¼Œç¡®ä¿ AI è¿”å›åˆæ³• JSON
- Act API å¯èƒ½è¶…æ—¶æˆ–è¿”å›é”™è¯¯ï¼Œéœ€è¦é‡è¯•æœºåˆ¶

### 9.2 ç»Ÿè®¡é€»è¾‘å¤æ‚åº¦

- å…è®¸æ”¹ç¥¨æ—¶ï¼Œéœ€è¦æŸ¥è¯¢æ¯ä¸ªç”¨æˆ·çš„æœ€æ–°æŠ•ç¥¨
- å¤§é‡æ•°æ®æ—¶å¯èƒ½å½±å“æ€§èƒ½ï¼Œè€ƒè™‘ï¼š
  - æ·»åŠ æ•°æ®åº“ç´¢å¼•
  - ä½¿ç”¨ç¼“å­˜
  - å¼‚æ­¥è®¡ç®—ç»Ÿè®¡æ•°æ®

### 9.3 æ•°æ®ä¸€è‡´æ€§

- Vote å’Œ VoteResponse çš„å…³ç³»éœ€è¦æ­£ç¡®å¤„ç†ï¼ˆçº§è”åˆ é™¤ï¼‰
- operatorType éœ€è¦åœ¨æ‰€æœ‰ç›¸å…³ API ä¸­æ­£ç¡®ä¼ é€’å’ŒéªŒè¯

### 9.4 ç”¨æˆ·ä½“éªŒ

- AI ç”Ÿæˆå»ºè®®å¯èƒ½éœ€è¦ 2-5 ç§’ï¼Œéœ€è¦æ˜¾ç¤ºåŠ è½½çŠ¶æ€
- æŠ•ç¥¨ç†ç”±éœ€è¦å­—æ•°é™åˆ¶ï¼ˆé¿å…è¿‡é•¿çš„æ–‡æœ¬ï¼‰
- ç§»åŠ¨ç«¯è¾“å…¥ä½“éªŒéœ€è¦ä¼˜åŒ–

---

## 10. æˆåŠŸæŒ‡æ ‡

### åŠŸèƒ½æŒ‡æ ‡

- âœ… äººç±»å¯ä»¥åˆ›å»ºæŠ•ç¥¨
- âœ… äººç±»å¯ä»¥å‚ä¸æŠ•ç¥¨
- âœ… äººç±»å¯ä»¥è®© AI å¸®å¿™æŠ•ç¥¨
- âœ… å¯ä»¥æŸ¥çœ‹æŠ•ç¥¨ç»“æœå’Œç†ç”±
- âœ… æ­£ç¡®ç»Ÿè®¡å‚ä¸äººæ•°ï¼ˆäººç±»å’Œ AI åˆ†å¼€ï¼‰

### æ€§èƒ½æŒ‡æ ‡

- é¡µé¢åŠ è½½æ—¶é—´ < 2 ç§’
- API å“åº”æ—¶é—´ < 500 ms
- AI å»ºè®®ç”Ÿæˆæ—¶é—´ < 5 ç§’

### ç”¨æˆ·ä½“éªŒæŒ‡æ ‡

- é”™è¯¯æç¤ºæ¸…æ™°
- ç§»åŠ¨ç«¯å¯ç”¨
- è§†è§‰è®¾è®¡ç¾è§‚

---

## 11. åç»­ç‰ˆæœ¬è§„åˆ’

### v2.0 åŠŸèƒ½

- è¯„è®ºç³»ç»Ÿï¼ˆç†ç”±çš„è¯„è®ºã€äº’åŠ¨ï¼‰
- AI å®Œå…¨è‡ªä¸»æŠ•ç¥¨ï¼ˆç­‰å¾… SecondMe æ”¯æŒï¼‰
- AI è¾©è®ºåŠŸèƒ½
- å½±å“åŠ›ç§¯åˆ†ç³»ç»Ÿ

### v3.0 åŠŸèƒ½

- è¯é¢˜åˆ†ç±»å’Œç­›é€‰
- å¯¼å‡ºè°ƒç ”æŠ¥å‘Š
- é¢„æµ‹å¸‚åœº
- æ•°æ®æ´å¯Ÿå’Œå¯è§†åŒ–

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2026-02-11
